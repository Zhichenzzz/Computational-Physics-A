# 计算物理第十七次实验报告

​															**曾郅琛 PB20071431**

**摘要：**本次实验利用*C++*程序语言以及*Python*绘制DLA散点图以及***GIF*动态图，**同时通过对生成的DLA点列进行数据处理，在指定像素点的框内标注DLA生长情况，利用回转半径法和盒计数法来计算DLA的分形维数。

**目录：**

[TOC]

## Diffusion Limited Aggregation (DLA)

### 算法实现与理论解释

​	DLA模型解释为：首先置一初始粒子作为种子，在远离种子的任意位置（在实现中采用足够远的圆边界）随机产生一个粒子使其做随机行走，直至与种子接触，成为集团的一部分；然后再随机产生一个粒子重复上述过程，这样就可以得到足够大的DLA cluster.

- 定义库函数`Particle.h/.cpp`，其中定义了`Class Particle`，代表每个粒子的类，里面包含粒子位置x，y以及内部函数和外部函数；
- 首先在类重载了向量的加减乘除四则运算operate，以及定义了两个粒子的距离函数；
- 在外部函数中，首先是随机游走函数`Rdm_walk(Particle *part)`，利用此前的16807随机数生成器，进行粒子的随机行走；
- `Set_initial()`为粒子的初始化，在算法中我们以节省内存空间为主要，设置了两个全局变量——`Particle unfree_particle[NUM_PARTICLE]，Particle free_particle[NUM_WALKING];`，作为聚集的粒子和正在随机游走的粒子存储的类的数组；
- `if_Diffusion()`为此次模拟中的核心函数，即判断随机游动的粒子是否聚集到已经停止的粒子上，若碰到，则利用类的拷贝重载，将随机游走的粒子x，y赋给静止粒子数组，同时自己回到设定的边界出，重新随机游走；
- 值得注意的是，`Change_Circle()`为改变初始的粒子出发圆半径的函数，通过判断目前占有的粒子数决定是否修改出发时的圆半径；
- 在本问题中，尝试了两种边界——一种是正常的圆边界`Circle_particle()`，另一种尝试了正方形边界`Square_particle()`，并画出相应的散点图。

### 数据生成与选择

​	首先我们通过上述的DLA算法生成10000个cluster，保存在文件中，再利用C++代码数据清洗，对生成的点在$240 \times 240$的像素点平面内计数，有点记为1，否则为0，此过程在`main.cpp`中实现

​	最终我们后续计算分形维数都基于数据清洗后的txt文件。

### DLA图与视频展示

​	10000个点生成的DLA图形如下：

<img src="C:\Users\HUAWEI\AppData\Roaming\Typora\typora-user-images\image-20221222233730307.png" alt="image-20221222233730307" style="zoom: 50%;" />

​	**click即可查看mp4形式视频**

<img src="C:\Users\HUAWEI\AppData\Roaming\Typora\typora-user-images\image-20221222233730307.png" alt="image-20221222233730307" style="zoom: 50%;" />

## 盒计数法

### 算法描述

​	函数`void Box_counting(const int p[][240])`  中对盒计数法算法进行设计，我们选取240的约数作为盒的分割大小，对每个盒内是否有粒子进行统计，有则记为1，最后计算总占比；

### 计算结果和拟合曲线

<img src="D:\Courses\ComputerPhysics\homework_17\report\Box.jpg" alt="Box" style="zoom: 150%;" />

​	**利用origin画图，盒计数法计算得的分形维数为$1.63235$，拟合曲线$R^2=0.99917$。**



## 回转半径法 (*Sandbox method* )

### 算法描述

​	在函数`void Sandbox(const int p[][240])` 中通过选取以原点为中心不同边长大小的正方形框对DLA点簇进行统计框内粒子数量。

​	选取边长为10，20，30，40，50，60，70，80，90，100的正方形边框，依次计算box内的占据点数，拟合出以分形维数为参数的曲线图

### 计算结果和拟合曲线

<img src="D:\Courses\ComputerPhysics\homework_17\report\sandbox.jpg" alt="sandbox" style="zoom:150%;" />

​	**利用origin画图，sandbox法计算得的分形维数为$1.60407$，拟合曲线$R^2=0.99921$。**

​	两种计算结果相差较小，且均在1.6~1.7范围内，非常符合理论，证明DLA生成的粒子簇效果较好！

## 总结

​	最后一次实验了，由于夺冠（希望助教们继续坚守决赛圈www）导致最后的报告交的比较晚而且做的很仓促，回想计算物理一学期的学习和课程作业，从蒙特卡罗方法到重要抽样，再到孙老师讲的四节有关混沌、分子动力学的问题，总的来说内容很多，收获很多，虽然确实会有一些累，但在过程中真的可以学到不少编程、物理模型的东西……

​	今天刚退烧，计算物理完结撒花 ~ 开森！

